import{J as S,B as C,L as k,M as G,aO as L,T as A,r as i,o as _,l as v,w as p,h as n,t as g,u as s,e as w,y as q,f as u,F as O,i as z,U as D,k as M,G as F,aN as T,D as J}from"./vendor.7b75e1d8.js";import{u as Y,b as N,c as R,d as H,e as K}from"./main.95b7e1a2.js";import{u as V}from"./exchange-rate.32e4d0cd.js";import{N as P}from"./NotificationRoot.ad94789e.js";import{V as Q}from"./index.esm.01beb047.js";const W={class:"font-medium text-lg text-left"},X={class:"mt-2 text-sm leading-snug text-gray-500",style:{"max-width":"680px"}},Z=["onSubmit"],ee={class:"text-gray-500 sm:text-sm"},te={class:"text-gray-400 text-xs mt-2 font-light"},ae={slot:"footer",class:"z-0 flex justify-end mt-4 pt-4 border-t border-gray-200 border-solid border-modal-bg"},se={emits:["update"],setup(B,{emit:o}){const e=V();Y();const t=N(),{t:l,tm:h}=S();let r=C(!1);C(!1);const f={exchange_rate:{required:k.withMessage(l("validation.required"),G),decimal:k.withMessage(l("validation.valid_exchange_rate"),L)}},x=A();async function y(){if(x.value.$touch(),x.value.$invalid)return!0;r.value=!0;let a=e.bulkCurrencies.map(d=>({id:d.id,exchange_rate:d.exchange_rate})),c=await e.updateBulkExchangeRate({currencies:a});c.data.success&&o("update",c.data.success),r.value=!1}return(a,c)=>{const d=i("BaseInput"),U=i("BaseInputGroup"),E=i("BaseButton"),I=i("BaseCard");return _(),v(I,null,{default:p(()=>[n("h6",W,g(a.$t("settings.exchange_rate.title")),1),n("p",X,g(a.$t("settings.exchange_rate.description",{currency:s(t).selectedCompanyCurrency.name})),1),n("form",{action:"",onSubmit:D(y,["prevent"])},[(_(!0),w(O,null,q(s(e).bulkCurrencies,(m,j)=>(_(),v(s(Q),{key:j,state:m,rules:f},{default:p(({v:b})=>[u(U,{class:"my-5",label:`${m.code} to ${s(t).selectedCompanyCurrency.code}`,error:b.exchange_rate.$error&&b.exchange_rate.$errors[0].$message,required:""},{default:p(()=>[u(d,{modelValue:m.exchange_rate,"onUpdate:modelValue":$=>m.exchange_rate=$,addon:`1 ${m.code} =`,invalid:b.exchange_rate.$error,onInput:$=>b.exchange_rate.$touch()},{right:p(()=>[n("span",ee,g(s(t).selectedCompanyCurrency.code),1)]),_:2},1032,["modelValue","onUpdate:modelValue","addon","invalid","onInput"]),n("span",te,g(a.$t("settings.exchange_rate.exchange_help_text",{currency:m.code,baseCurrency:s(t).selectedCompanyCurrency.code})),1)]),_:2},1032,["label","error"])]),_:2},1032,["state"]))),128)),n("div",ae,[u(E,{loading:s(r),variant:"primary",type:"submit"},{default:p(()=>[z(g(a.$t("general.save")),1)]),_:1},8,["loading"])])],40,Z)]),_:1})}}},oe={setup(B){const o=R(),e=M(()=>o.active&&o.componentName==="ExchangeRateBulkUpdateModal");function t(){o.closeModal()}return(l,h)=>{const r=i("BaseModal");return _(),v(r,{show:s(e)},{default:p(()=>[u(se,{onUpdate:h[0]||(h[0]=f=>t())})]),_:1},8,["show"])}}},ne={key:0,class:"h-full"},re={class:"h-screen h-screen-ios overflow-y-auto min-h-0"},ce={class:""},_e={setup(B){const o=H(),e=F(),t=K(),l=T(),h=R();S();const r=V(),f=N(),x=M(()=>o.isAppLoaded);return J(()=>{o.bootstrap().then(y=>{e.meta.ability&&!t.hasAbilities(e.meta.ability)?l.push({name:"account.settings"}):e.meta.isOwner&&!t.currentUser.is_owner&&l.push({name:"account.settings"}),y.data.current_company_settings.bulk_exchange_rate_configured==="NO"&&r.fetchBulkCurrencies().then(a=>{if(a.data.currencies.length)h.openModal({componentName:"ExchangeRateBulkUpdateModal",size:"sm"});else{let c={settings:{bulk_exchange_rate_configured:"YES"}};f.updateCompanySettings({data:c})}})})}),(y,a)=>{const c=i("router-view"),d=i("BaseGlobalLoader");return s(x)?(_(),w("div",ne,[u(P),u(oe),n("main",re,[n("div",ce,[u(c)])])])):(_(),v(d,{key:1}))}}};export{_e as default};
